from cefpython3 import cefpython as cef
import platform
import sys
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import threading

def main():
    # us_cities = pd.read_csv("https://raw.githubusercontent.com/plotly/datasets/master/us-cities-top-1k.csv")
    # fig = px.scatter_mapbox(us_cities, lat="lat", lon="lon", hover_name="City", hover_data=["State", "Population"],
    #                         color_discrete_sequence=["fuchsia"], zoom=3, height=1000, mapbox_style="stamen-terrain")
    # fig.update_layout(margin={"r": 0, "t": 0, "l": 0, "b": 0})
    # fig.write_html("map.html")

    fig = go.Figure()

    # Create scatter trace of text labels
    fig.add_trace(go.Scatter(
        x=[1.5, 3.5],
        y=[0.75, 2.5],
        text=["Filled Circle"],
        mode="text",
    ))

    # Set axes properties
    fig.update_xaxes(range=[0, 4.5], zeroline=False)
    fig.update_yaxes(range=[0, 4.5])

    # Add circles
    fig.add_shape(type="circle",
                  xref="x", yref="y",
                  fillcolor="PaleTurquoise",
                  x0=3, y0=3, x1=4, y1=4,
                  line_color="LightSeaGreen",
                  )

    fig = go.Figure(go.Scattermapbox(
        mode="markers",
        lon=[-82.4], lat=[36.3],
        marker={'size': 20, 'color': ["cyan"]}))

    fig.update_layout(
        mapbox={
            'style': "stamen-terrain",
            'center': {'lon': -82.4, 'lat': 36.3},
            'zoom': 12, 'layers': [
                {
                'source': {
                    'type': "FeatureCollection",
                    'features': [{
                        'type': "Feature",
                        'geometry': {
                            'type': "MultiPolygon",
                            'coordinates': [[[
                                [-82.399999, 34.950836],
                                [-82.371275, 34.951039],
                                [-82.342559, 34.951645],
                                [-82.313859, 34.952654],
                                [-82.285184, 34.954068],
                                [-82.256543, 34.955884],
                                [-82.227943, 34.958103],
                                [-82.199393, 34.960724],
                                [-82.170901, 34.963747],
                                [-82.142475, 34.967169],
                                [-82.114124, 34.970991],
                                [-82.085856, 34.975211],
                                [-82.057678, 34.979828],
                                [-82.029600, 34.984841],
                                [-82.001630, 34.990248],
                                [-81.973775, 34.996047],
                                [-81.946043, 35.002238],
                                [-81.918444, 35.008817],
                                [-81.890984, 35.015784],
                                [-81.863671, 35.023136],
                                [-81.836515, 35.030871],
                                [-81.809522, 35.038987],
                                [-81.782700, 35.047482],
                                [-81.756058, 35.056352],
                                [-81.729604, 35.065596],
                                [-81.703344, 35.075210],
                                [-81.677286, 35.085193],
                                [-81.651439, 35.095540],
                                [-81.625810, 35.106250],
                                [-81.600406, 35.117318],
                                [-81.575236, 35.128742],
                                [-81.550305, 35.140519],
                                [-81.525623, 35.152644],
                                [-81.501195, 35.165115],
                                [-81.477029, 35.177927],
                                [-81.453134, 35.191078],
                                [-81.429514, 35.204562],
                                [-81.406178, 35.218377],
                                [-81.383133, 35.232518],
                                [-81.360385, 35.246981],
                                [-81.337942, 35.261761],
                                [-81.315809, 35.276856],
                                [-81.293994, 35.292259],
                                [-81.272504, 35.307966],
                                [-81.251344, 35.323974],
                                [-81.230521, 35.340277],
                                [-81.210041, 35.356870],
                                [-81.189911, 35.373749],
                                [-81.170137, 35.390909],
                                [-81.150725, 35.408343],
                                [-81.131681, 35.426049],
                                [-81.113010, 35.444019],
                                [-81.094719, 35.462250],
                                [-81.076812, 35.480735],
                                [-81.059296, 35.499469],
                                [-81.042176, 35.518447],
                                [-81.025458, 35.537662],
                                [-81.009146, 35.557110],
                                [-80.993246, 35.576784],
                                [-80.977762, 35.596679],
                                [-80.962700, 35.616789],
                                [-80.948064, 35.637107],
                                [-80.933860, 35.657628],
                                [-80.920091, 35.678346],
                                [-80.906762, 35.699255],
                                [-80.893877, 35.720348],
                                [-80.881441, 35.741618],
                                [-80.869458, 35.763061],
                                [-80.857931, 35.784669],
                                [-80.846864, 35.806435],
                                [-80.836261, 35.828354],
                                [-80.826126, 35.850419],
                                [-80.816462, 35.872623],
                                [-80.807272, 35.894960],
                                [-80.798559, 35.917422],
                                [-80.790327, 35.940004],
                                [-80.782578, 35.962697],
                                [-80.775315, 35.985497],
                                [-80.768541, 36.008395],
                                [-80.762258, 36.031385],
                                [-80.756468, 36.054460],
                                [-80.751174, 36.077612],
                                [-80.746378, 36.100836],
                                [-80.742081, 36.124124],
                                [-80.738286, 36.147468],
                                [-80.734993, 36.170862],
                                [-80.732205, 36.194300],
                                [-80.729922, 36.217772],
                                [-80.728146, 36.241273],
                                [-80.726877, 36.264796],
                                [-80.726118, 36.288333],
                                [-80.725867, 36.311877],
                                [-80.726127, 36.335421],
                                [-80.726896, 36.358958],
                                [-80.728177, 36.382480],
                                [-80.729967, 36.405981],
                                [-80.732268, 36.429453],
                                [-80.735079, 36.452889],
                                [-80.738400, 36.476282],
                                [-80.742230, 36.499624],
                                [-80.746569, 36.522909],
                                [-80.751416, 36.546130],
                                [-80.756769, 36.569279],
                                [-80.762627, 36.592349],
                                [-80.768990, 36.615333],
                                [-80.775855, 36.638224],
                                [-80.783221, 36.661015],
                                [-80.791086, 36.683700],
                                [-80.799448, 36.706270],
                                [-80.808305, 36.728718],
                                [-80.817655, 36.751039],
                                [-80.827495, 36.773225],
                                [-80.837822, 36.795270],
                                [-80.848635, 36.817165],
                                [-80.859929, 36.838905],
                                [-80.871702, 36.860483],
                                [-80.883950, 36.881892],
                                [-80.896670, 36.903126],
                                [-80.909859, 36.924177],
                                [-80.923513, 36.945040],
                                [-80.937628, 36.965707],
                                [-80.952200, 36.986173],
                                [-80.967224, 37.006431],
                                [-80.982697, 37.026474],
                                [-80.998613, 37.046296],
                                [-81.014969, 37.065892],
                                [-81.031759, 37.085255],
                                [-81.048979, 37.104378],
                                [-81.066624, 37.123256],
                                [-81.084687, 37.141883],
                                [-81.103164, 37.160254],
                                [-81.122050, 37.178361],
                                [-81.141339, 37.196200],
                                [-81.161024, 37.213765],
                                [-81.181100, 37.231051],
                                [-81.201562, 37.248051],
                                [-81.222401, 37.264761],
                                [-81.243614, 37.281176],
                                [-81.265192, 37.297289],
                                [-81.287130, 37.313097],
                                [-81.309420, 37.328593],
                                [-81.332056, 37.343774],
                                [-81.355030, 37.358633],
                                [-81.378337, 37.373168],
                                [-81.401967, 37.387372],
                                [-81.425915, 37.401242],
                                [-81.450173, 37.414772],
                                [-81.474733, 37.427960],
                                [-81.499588, 37.440800],
                                [-81.524729, 37.453288],
                                [-81.550149, 37.465421],
                                [-81.575840, 37.477194],
                                [-81.601794, 37.488604],
                                [-81.628003, 37.499647],
                                [-81.654458, 37.510320],
                                [-81.681151, 37.520619],
                                [-81.708074, 37.530541],
                                [-81.735219, 37.540083],
                                [-81.762575, 37.549242],
                                [-81.790136, 37.558014],
                                [-81.817892, 37.566397],
                                [-81.845834, 37.574389],
                                [-81.873954, 37.581986],
                                [-81.902242, 37.589187],
                                [-81.930690, 37.595988],
                                [-81.959288, 37.602389],
                                [-81.988027, 37.608386],
                                [-82.016899, 37.613978],
                                [-82.045893, 37.619163],
                                [-82.075001, 37.623939],
                                [-82.104214, 37.628305],
                                [-82.133521, 37.632259],
                                [-82.162914, 37.635801],
                                [-82.192383, 37.638929],
                                [-82.221918, 37.641642],
                                [-82.251511, 37.643938],
                                [-82.281152, 37.645819],
                                [-82.310830, 37.647282],
                                [-82.340538, 37.648327],
                                [-82.370264, 37.648954],
                                [-82.400001, 37.649164],
                                [-82.429736, 37.648954],
                                [-82.459462, 37.648327],
                                [-82.489170, 37.647282],
                                [-82.518848, 37.645819],
                                [-82.548489, 37.643938],
                                [-82.578082, 37.641642],
                                [-82.607617, 37.638929],
                                [-82.637086, 37.635801],
                                [-82.666479, 37.632259],
                                [-82.695786, 37.628305],
                                [-82.724999, 37.623939],
                                [-82.754107, 37.619163],
                                [-82.783101, 37.613978],
                                [-82.811973, 37.608386],
                                [-82.840712, 37.602389],
                                [-82.869310, 37.595988],
                                [-82.897758, 37.589187],
                                [-82.926046, 37.581986],
                                [-82.954166, 37.574389],
                                [-82.982108, 37.566397],
                                [-83.009864, 37.558014],
                                [-83.037425, 37.549242],
                                [-83.064781, 37.540083],
                                [-83.091926, 37.530541],
                                [-83.118849, 37.520619],
                                [-83.145542, 37.510320],
                                [-83.171997, 37.499647],
                                [-83.198206, 37.488604],
                                [-83.224160, 37.477194],
                                [-83.249851, 37.465421],
                                [-83.275271, 37.453288],
                                [-83.300412, 37.440800],
                                [-83.325267, 37.427960],
                                [-83.349827, 37.414772],
                                [-83.374085, 37.401242],
                                [-83.398033, 37.387372],
                                [-83.421663, 37.373168],
                                [-83.444970, 37.358633],
                                [-83.467944, 37.343774],
                                [-83.490580, 37.328593],
                                [-83.512870, 37.313097],
                                [-83.534808, 37.297289],
                                [-83.556386, 37.281176],
                                [-83.577599, 37.264761],
                                [-83.598438, 37.248051],
                                [-83.618900, 37.231051],
                                [-83.638976, 37.213765],
                                [-83.658661, 37.196200],
                                [-83.677950, 37.178361],
                                [-83.696836, 37.160254],
                                [-83.715313, 37.141883],
                                [-83.733376, 37.123256],
                                [-83.751021, 37.104378],
                                [-83.768241, 37.085255],
                                [-83.785031, 37.065892],
                                [-83.801387, 37.046296],
                                [-83.817303, 37.026474],
                                [-83.832776, 37.006431],
                                [-83.847800, 36.986173],
                                [-83.862372, 36.965707],
                                [-83.876487, 36.945040],
                                [-83.890141, 36.924177],
                                [-83.903330, 36.903126],
                                [-83.916050, 36.881892],
                                [-83.928298, 36.860483],
                                [-83.940071, 36.838905],
                                [-83.951365, 36.817165],
                                [-83.962178, 36.795270],
                                [-83.972505, 36.773225],
                                [-83.982345, 36.751039],
                                [-83.991695, 36.728718],
                                [-84.000552, 36.706270],
                                [-84.008914, 36.683700],
                                [-84.016779, 36.661015],
                                [-84.024145, 36.638224],
                                [-84.031010, 36.615333],
                                [-84.037373, 36.592349],
                                [-84.043231, 36.569279],
                                [-84.048584, 36.546130],
                                [-84.053431, 36.522909],
                                [-84.057770, 36.499624],
                                [-84.061600, 36.476282],
                                [-84.064921, 36.452889],
                                [-84.067732, 36.429453],
                                [-84.070033, 36.405981],
                                [-84.071823, 36.382480],
                                [-84.073104, 36.358958],
                                [-84.073873, 36.335421],
                                [-84.074133, 36.311877],
                                [-84.073882, 36.288333],
                                [-84.073123, 36.264796],
                                [-84.071854, 36.241273],
                                [-84.070078, 36.217772],
                                [-84.067795, 36.194300],
                                [-84.065007, 36.170862],
                                [-84.061714, 36.147468],
                                [-84.057919, 36.124124],
                                [-84.053622, 36.100836],
                                [-84.048826, 36.077612],
                                [-84.043532, 36.054460],
                                [-84.037742, 36.031385],
                                [-84.031459, 36.008395],
                                [-84.024685, 35.985497],
                                [-84.017422, 35.962697],
                                [-84.009673, 35.940004],
                                [-84.001441, 35.917422],
                                [-83.992728, 35.894960],
                                [-83.983538, 35.872623],
                                [-83.973874, 35.850419],
                                [-83.963739, 35.828354],
                                [-83.953136, 35.806435],
                                [-83.942069, 35.784669],
                                [-83.930542, 35.763061],
                                [-83.918559, 35.741618],
                                [-83.906123, 35.720348],
                                [-83.893238, 35.699255],
                                [-83.879909, 35.678346],
                                [-83.866140, 35.657628],
                                [-83.851936, 35.637107],
                                [-83.837300, 35.616789],
                                [-83.822238, 35.596679],
                                [-83.806754, 35.576784],
                                [-83.790854, 35.557110],
                                [-83.774542, 35.537662],
                                [-83.757824, 35.518447],
                                [-83.740704, 35.499469],
                                [-83.723188, 35.480735],
                                [-83.705281, 35.462250],
                                [-83.686990, 35.444019],
                                [-83.668319, 35.426049],
                                [-83.649275, 35.408343],
                                [-83.629863, 35.390909],
                                [-83.610089, 35.373749],
                                [-83.589959, 35.356870],
                                [-83.569479, 35.340277],
                                [-83.548656, 35.323974],
                                [-83.527496, 35.307966],
                                [-83.506006, 35.292259],
                                [-83.484191, 35.276856],
                                [-83.462058, 35.261761],
                                [-83.439615, 35.246981],
                                [-83.416867, 35.232518],
                                [-83.393822, 35.218377],
                                [-83.370486, 35.204562],
                                [-83.346866, 35.191078],
                                [-83.322971, 35.177927],
                                [-83.298805, 35.165115],
                                [-83.274377, 35.152644],
                                [-83.249695, 35.140519],
                                [-83.224764, 35.128742],
                                [-83.199594, 35.117318],
                                [-83.174190, 35.106250],
                                [-83.148561, 35.095540],
                                [-83.122714, 35.085193],
                                [-83.096656, 35.075210],
                                [-83.070396, 35.065596],
                                [-83.043942, 35.056352],
                                [-83.017300, 35.047482],
                                [-82.990478, 35.038987],
                                [-82.963485, 35.030871],
                                [-82.936329, 35.023136],
                                [-82.909016, 35.015784],
                                [-82.881556, 35.008817],
                                [-82.853957, 35.002238],
                                [-82.826225, 34.996047],
                                [-82.798370, 34.990248],
                                [-82.770400, 34.984841],
                                [-82.742322, 34.979828],
                                [-82.714144, 34.975211],
                                [-82.685876, 34.970991],
                                [-82.657525, 34.967169],
                                [-82.629099, 34.963747],
                                [-82.600607, 34.960724],
                                [-82.572057, 34.958103],
                                [-82.543457, 34.955884],
                                [-82.514816, 34.954068],
                                [-82.486141, 34.952654],
                                [-82.457441, 34.951645],
                                [-82.428725, 34.951039],
                                [-82.400001, 34.950836],

                            ]]]
                        }
                    }]
                },
                'type': "fill", 'below': "traces", 'color': "royalblue", 'opacity': 0.5}
            ]},
        margin={'l': 0, 'r': 0, 'b': 0, 't': 0})

    fig.write_html("map.html")

    check_versions()
    sys.excepthook = cef.ExceptHook  # To shutdown all CEF processes on error
    cef.Initialize()
    cef.CreateBrowserSync(url="file:///map.html",
                          window_title="Kintronic Labs")
    cef.MessageLoop()
    cef.Shutdown()


def check_versions():
    ver = cef.GetVersion()
    print("[hello_world.py] CEF Python {ver}".format(ver=ver["version"]))
    print("[hello_world.py] Chromium {ver}".format(ver=ver["chrome_version"]))
    print("[hello_world.py] CEF {ver}".format(ver=ver["cef_version"]))
    print("[hello_world.py] Python {ver} {arch}".format(
           ver=platform.python_version(),
           arch=platform.architecture()[0]))
    assert cef.__version__ >= "57.0", "CEF Python v57.0+ required to run this"


if __name__ == '__main__':
    main()